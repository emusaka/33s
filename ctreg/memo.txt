
ワークシート関数表記はうまく行かないので、本来のVBAで実施。

Sub aaaaa()
MsgBox ctreg("ぶっく1.xlsx", "シート1")
End Sub
を新規ファイルに作っておく。

"ぶっく1.xlsx", "シート1"
を作り、あらかじめ、
sono1n.PNG
に示す内容を入れておく。

ここで、
ctrl+endで
sono1n.PNG
にあるセルにカーソルが移る（B7セル）。

aaaaaを実施する。
７が表示され、ctrl+endでいく行が表示される。

次に、
sono2.PNG
のように、
６〜８行を隠す。
ここで、ctrl+endを押すと、
sono2.PNG
に示すようにカーソルが移る(B5セル)。

手作業だと、５行目が最終行を思い込む恐れがある。
実際は、７行目が最終行である。

aaaaaは、隠れた行も考慮し、データとしての最終行を表示する。
隠れている場合、隠れた行の最終行を表示する。だから、８。
実際はデータ最終行は、７だが無視はされない。


